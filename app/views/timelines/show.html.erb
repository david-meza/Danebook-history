<main class = "container">

  <%= render :partial => 'shared/middle_navbar' %>

    <section class = "container" id="timeline-section">
      <div class="row">

        <aside class="col-md-4" id="basic-info">
          <%= render partial: 'timeline_about' %>
          <%= render partial: 'timeline_photos' %>
          <%= render partial: 'timeline_friends' %>
        </aside>


        <!-- //////// news feed = right side of screen ////////-->
        <div class="col-md-7 col-md-offset-1" id="news-feed">

          <%= render partial: 'post_form' %>

<!--  Posted posts -->
          <% current_user.posts.each do |post| %>
            <article class = "feed-posts">
              <div class="row">
                <div class="col-xs-2">
                  <%=image_tag "user_silhouette_generic.gif", width: "50px", height: "50px" %>
                </div>
                <div class="col-xs-10">
                  <p>
                    <%= link_to current_user.name, current_user %>
                  </p>
                  <p class="date-posted">
                    Posted on <%= post.created_at.to_formatted_s(:long) %>
                  </p>
                </div>
              </div>

              <div class = "row">
                <div class="col-md-12 post-body">
                  <p>
                    <%= post.body %>
                  </p>
                </div>
              </div>

              <div class = "row">
                <footer class="col-md-12 like-section">
                  <div class = "row">
                    <% if post.liked? %>
                      <%= link_to "Unlike", like_path(post_id: post.id), method: :delete, class: "col-xs-2" %>
                    <% else %>
                      <%= link_to "Like", like_path(post_id: post.id), method: :post, class: "col-xs-2" %>
                    <% end -%>
                    <a class="col-xs-2" href="#">Comment</a>
                    <%= link_to "Delete", post_path(post), method: :delete, class: "col-xs-1 col-xs-offset-6", data: {confirm: "Are you sure you want to delete this post?"} %>
                  </div>

                  <div class = "row">
                    <p class="col-xs-12">
                      <% if post.likes.count > 3 %>
                        <% post.likes[0..2].each do |like| %>
                          <%= link_to like.user.name, user_path(like.user.id) %>,
                        <% end -%> and <%= post.likes.count-3 %> others like this
                      <% elsif post.likes.count <= 0 %>
                        Be the first one to like this!
                      <% else %>
                        <% post.likes.each do |like| %>
                          <%= link_to like.user.name, user_path(like.user.id) %>
                        <% end -%> <%= post.likes.count == 1 ? "likes" : "like" %> this
                      <% end -%>
                    </p>
                  </div>

                  <div class = "divider-line"></div>

<!-- Start Comments / Responses -->
                  <% post.comments.each do |comment| %>
                  <div class = "row">
                    <div class="col-xs-2">
                      <%=image_tag "user_silhouette_generic.gif", width: "50px", height: "50px" %>
                    </div>

                    <div class="col-xs-10">
                      <div class = "row">
                        <p class="col-md-12">
                          <%= link_to comment.author.name, user_path(comment.author) %> <span>said on <%= comment.created_at.to_formatted_s(:long) %></span>
                        </p>
                      </div>
                      <div class = "row">
                        <p class="col-md-12">
                          <%= comment.body %>
                        </p>
                      </div>
                      <div class = "row">
                        <a href="#" class="col-xs-2">Like</a>
                        <span class="col-xs-10">3 other people like this</span>
                      </div>
                    </div>
                  </div> <!-- End Comments / Responses -->
                  <% end -%>

<!-- Comments form for new comments -->
                  <%= form_for [post, @comment] do |comment_fields| %>
                    <div class="col-md-12">
                      <div class="form-group">
                        <%= comment_fields.text_area :body, class: "form-control", rows: "4", placeholder: "Write a comment..." %>
                        <%= comment_fields.hidden_field(:author_id, value: current_user.id) %>
                        <%= comment_fields.hidden_field(:commentable_type, value: post.class.to_s) %>
                        <%= comment_fields.hidden_field(:commentable_id, value: post.id) %>
                      </div>
                      <div class="form-group">
                        <a class="col-md-1" href="#">Cancel</a>
                        <%= comment_fields.submit "Comment", class: "col-md-3 pull-right btn btn-primary" %>
                      </div>
                    </div>
                  <% end -%><!-- End Comments form -->
                </footer>
              </div>
            </article>
          <% end -%><!-- Posted posts end-->
        </div>
      </div>
    </div>
  </section>
</main>

<br>